<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shared Notes</title>
    <link rel="stylesheet" href="./style.css">
</head>
<body>
    <div id="app">
        <header>
            <div id="upbar">
                <div id="title">
                    <h1>
                        shared notes
                    </h1>
                </div>
                <div id="butons">
                    <div id="save">
                        <button id="saveButton" title="Sauvegarder">üíæ</button>
                    </div>
                    <div id="edit">
                        <img src="edit.png" alt="modifier">
                    </div>
                    <div id="synchro">
                        <div id="synchroImg">
                            <img src="synchro.png" alt="indicateur de synchronisation">
                        </div>
                        <div id="synchroTxt">
                            <p>
                                d√©synchronis√©...
                            </p>
                        </div>
                    </div>
                    <div id="actualiser">
                        <img src="actualiser.png" alt="actualiser" id="refreshImg">
                    </div>
                </div>
            </div>
        </header>
        <main>
            <div id="textDiv">
                <textarea id="noteArea" placeholder="√âcris ici..."></textarea>
            </div>
        </main>
    </div>
    <script>
        function save(){
            const noteArea = document.getElementById('noteArea');
            const noteContent = noteArea.value;
            localStorage.setItem('sharedNote', noteContent);
            // Use the boolean property to reliably disable the textarea
            noteArea.disabled = true;
            const synchroTxt = document.getElementById('synchroTxt').getElementsByTagName('p')[0];
            synchroTxt.textContent = 'sauvegard√©';
            setTimeout(() => {
                synchroTxt.textContent = 'd√©synchronis√©...';
            }, 2000);
        }
        function edit(){
            const noteArea = document.getElementById('noteArea');
            // Re-enable via the boolean property
            noteArea.disabled = false;
            noteArea.focus();
        }
        function refresh(){
            const savedNote = localStorage.getItem('sharedNote');
            const noteArea = document.getElementById('noteArea');
            if(savedNote !== null){
                noteArea.value = savedNote;
                // If there's a saved note we assume it's the current saved state and disable editing
                noteArea.disabled = true;
                const synchroTxt = document.getElementById('synchroTxt').getElementsByTagName('p')[0];
                synchroTxt.textContent = 'synchronis√©';
                setTimeout(() => {
                    synchroTxt.textContent = 'd√©synchronis√©...';
                }, 2000);
            }
        }
        document.getElementById('saveButton').addEventListener('click', save);
        document.getElementById('edit').addEventListener('click', edit);
        document.getElementById('actualiser').addEventListener('click', refresh);
        window.onload = refresh;
    </script>
</body>
</html>
